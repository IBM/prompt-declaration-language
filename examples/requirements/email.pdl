description: Hello world calling a model
defs:
  eval: 
    function:
      requirement: string
      response: string
    return:
      lastOf:
      - model: ollama_chat/mistral-small:latest 
        def: result
        input: |
          Does the following email end with Kind regards. Answer with a JSON object and a result field with value True or False only.
          Email: ${ response }
        parser: json
      - ${ result.result }
      
  fix:
    function:
      requirement: string
      response: string
    return: 
      lastOf:
      - model: ollama_chat/mistral-small:latest 
        def: instruction
        input: |
          A model responded with the following response: ${ response }
          In order to satisfy the following requirement: ${ requirement }
          what should be added to the prompt as an instruction?

          Respond with only with the instruction.
      - ${ pdl_context }

  notes: Olivia helped the lab over the last few weeks by organizing intern events, advertising the speaker series, and handling issues with snack delivery.
  name: Olivia
text:
- "Write an email to ${ name } using the notes following: ${ notes }"
- model: ollama_chat/granite3.2:2b
  requirements:
  - description: The email should end with Kind regards
    evaluate:  ${ eval }
    transformContext: ${ fix }
  retry: 5
